- alias: HOME TO_OFF
  trigger:
    - platform: state
      entity_id: input_boolean.at_home
      from: "on"
      to: "off"
      for: "00:00:05"
  action:
    - event: AD_MANAGE_HOME_ON_OFF
      event_data:
        mode: "notathome"

- alias: HOME TO_ON
  trigger:
    - platform: state
      entity_id: input_boolean.at_home
      from: "off"
      to: "on"
  action:
    - event: AD_MANAGE_HOME_ON_OFF
      event_data:
        mode: "athome"

- alias: AUTOMATION_H07
  trigger:
    - platform: time
      at: "07:00:00"
  action:
    - service: input_boolean.turn_off
      target:
        entity_id: input_boolean.night
    - event: AD_KAIROSHUB_STARTED

- alias: AUTOMATION_H20
  trigger:
    - platform: time
      at: "20:00:00"
  action:
    - service: input_boolean.turn_on
      target:
        entity_id: input_boolean.night
    - event: AD_KAIROSHUB_STARTED

- alias: HT UPDATE STATE
  trigger:
    - platform: state
      to: active
      entity_id:
        - sensor.TH1001
        - sensor.TH1011
        - sensor.TH1021
        - sensor.TH1031
        - sensor.TH1041
        - sensor.TH2001
        - sensor.TH2011
        - sensor.TH2021
        - sensor.TH2031
  action:
    - event: AD_SHELLY_UPDATE
      event_data:
        entity: "{{trigger.entity_id}}"
    - delay: "00:00:05"
    - event: AD_SHELLY_ASLEEP
      event_data:
        entity: "{{trigger.entity_id}}"

- alias: SHELLY STATUS CHECK
  trigger:
    - platform: time_pattern
      hours: "/1"
  action:
    event: AD_SHELLY_STATUS_CHECK

- alias: AP MODE
  trigger:
    - platform: event
      event_type: HA_AP_MODE
  action:
    - service: mqtt.publish
      data:
        topic: "kairostech/command"
        payload: "AP_MODE"
