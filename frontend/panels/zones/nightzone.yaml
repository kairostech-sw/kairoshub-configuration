type: 'custom:button-card'
template: clima_zone_grid
custom_fields:
  header:
    card:
      type: 'custom:button-card'
      entity: binary_sensor.heater_auto
      layout: vertical
      template:
        - header_page_text
      icon: 'mdi:thermometer'
      name: 'CLIMA'
      label: '[[[return "Clima / "+states["input_text.zn100"].state]]]'
  backbutton:
    card:
      type: 'custom:button-card'
      template: button_go_back
  zones:
    card:
      type: grid
      columns: 2
      square: false
      cards:
        - type: conditional
          conditions:
            - entity: sensor.tz101
              state_not: "unknown"
          card:
            type: 'custom:button-card'
            # entity: 'sensor.tz100'
            template: 'clima_tv_detail'
            styles:
              card:
                - box-shadow: none
                - height: 100px
            name: >
              [[[
                return states["input_text.zn101"].state;
              ]]]
            variables:
              temperature: >
                [[[
                  return states["sensor.tz101"].state;
                ]]]
              humidity: >
                [[[
                  return states["sensor.th1011_humidity"].state != "unavailable"? states["sensor.th1011_humidity"].state : "";
                ]]]
              # visibility: input_boolean.zn_100
              # state: >
              #   [[[
              #     return states["sensor.tv1011_state"].state;
              #   ]]]
              lastupdate: >
                [[[
                  var time =  states["sensor.tz101"].last_changed.split("T")[1].split(":");
                  return (+time[0]+1)+":"+time[1];
                ]]]
        - type: conditional
          conditions:
            - entity: sensor.tz102
              state_not: "unknown"
          card:
            type: 'custom:button-card'
            # entity: 'sensor.tz100'
            template: 'clima_tv_detail'
            styles:
              card:
                - box-shadow: none
            name: >
              [[[
                return states["input_text.zn102"].state;
              ]]]
            variables:
              temperature: >
                [[[
                  return states["sensor.tz102"].state;
                ]]]
              humidity: >
                [[[
                  return states["sensor.th1021_humidity"].state != "unavailable"? states["sensor.th1021_humidity"].state : "";
                ]]]
              # visibility: input_boolean.zn_100
              # state: >
              #   [[[
              #     return states["sensor.tv1021_state"].state;
              #   ]]]
              lastupdate: >
                [[[
                  var time =  states["sensor.tz102"].last_changed.split("T")[1].split(":");
                  return (+time[0]+1)+":"+time[1];
                ]]]
        - type: conditional
          conditions:
            - entity: sensor.tz103
              state_not: "unknown"
          card:
            type: 'custom:button-card'
            # entity: 'sensor.tz100'
            template: 'clima_tv_detail'
            styles:
              card:
                - box-shadow: none
            name: >
              [[[
                return states["input_text.zn103"].state;
              ]]]
            variables:
              temperature: >
                [[[
                  return states["sensor.tz103"].state;
                ]]]
              humidity: >
                [[[
                  return states["sensor.th1031_humidity"].state != "unavailable"? states["sensor.th1031_humidity"].state : "";
                ]]]
              # visibility: input_boolean.zn_100
              # state: >
              #   [[[
              #     return states["sensor.tv1031_state"].state;
              #   ]]]
              lastupdate: >
                [[[
                  var time =  states["sensor.tz103"].last_changed.split("T")[1].split(":");
                  return (+time[0]+1)+":"+time[1];
                ]]]
        - type: conditional
          conditions:
            - entity: sensor.tz104
              state_not: "unknown"
          card:
            type: 'custom:button-card'
            # entity: 'sensor.tz100'
            template: 'clima_tv_detail'
            styles:
              card:
                - box-shadow: none
            name: >
              [[[
                return states["input_text.zn104"].state;
              ]]]
            variables:
              temperature: >
                [[[
                  return states["sensor.tz104"].state;
                ]]]
              humidity: >
                [[[
                  return states["sensor.th1041_humidity"].state != "unavailable"? states["sensor.th1041_humidity"].state : "";
                ]]]
              # visibility: input_boolean.zn_100
              # state: >
              #   [[[
              #     return states["sensor.tv1041_state"].state;
              #   ]]]
              lastupdate: >
                [[[
                  var time =  states["sensor.tz104"].last_changed.split("T")[1].split(":");
                  return (+time[0]+1)+":"+time[1];
                ]]]