type: "custom:button-card"
style: |
  ha-card.button-card-main {
    padding: 0px !important
  }
template: command_bar
custom_fields:
  commands:
    card:
      type: horizontal-stack
      cards:
        - type: "custom:button-card"
          name: Notte
          template: icon_state_header
          entity: input_boolean.night
          label: "Notte"
          state:
            - value: "on"
              icon: "mdi:weather-night"
              label: "Notte"
              color: var(--command-state-color)
            - value: "off"
              icon: "mdi:weather-sunny"
              label: "Giorno"
              color: var(--command-state-color)
          tap_action:
            action: call-service
            service: automation.trigger
            service_data:
              entity_id: automation.day_night_scene_manual
          styles:
            card:
              - padding-top: 3px
        - type: conditional
          conditions:
            - entity: input_boolean.light_integration
              state: "on"
          card:
            type: custom:button-card
            template: icon_state_header
            name: Luci
            entity: group.lights
            icon: mdi:lightbulb
            state:
              - value: 'on'
                label: Accese
                color: var(--command-state-active-color)
              - value: 'off'
                label: Spente
                color: var(--command-state-color)
            styles:
              card:
                - padding-top: 3px
            tap_action:
              action: call-service
              service: automation.trigger
              service_data:
                entity_id: automation.light_toggle
        - type: conditional
          conditions:
            - entity: input_boolean.roller_integration
              state: "on"
          card:
            name: Tapparelle aperte
            type: "custom:button-card"
            template: icon_state_header
            label: "Aperte"
            entity: group.rollershutters
            color: var(--command-state-color)
            extra_styles: |
              @keyframes blink-alert {
                0% { opacity: 0.3; }
                50% { opacity: 1; }
                100% { opacity: 0.3; }
              }
            tap_action:
              action: call-service
              service: >
                [[[
                  if (states['group.rollershutters'].state === 'open')
                    return 'cover.close_cover';
                  else if (states['group.rollershutters'].state === 'closed')
                    return 'cover.open_cover';
                  else
                    return 'cover.stop_cover';
                ]]]
              service_data:
                entity_id: all
            state:
              - value: "open"
                icon: mdi:window-shutter-open
                label: Aperte
              - value: "closed"
                icon: mdi:window-shutter
                label: Chiuse
              - value: "moving"
                icon: mdi:pause-octagon-outline
                color: '#FF1500'
                label: Ferma
                styles:
                  icon:
                    - animation: blink-alert 2s ease infinite
            styles:
              card:
                - padding-top: 3px
        - type: "custom:button-card"
          entity: input_boolean.at_home
          template: icon_state_header
          icon: "mdi:home"
          tap_action:
            action: call-service
            service: input_boolean.toggle
            service_data:
              entity_id: input_boolean.at_home
          state:
            - value: "on"
              label: "In Casa"
              color: var(--command-state-active-color)
            - value: "off"
              label: "Fuori Casa"
              color: var(--command-state-color)
          styles:
            card:
              - padding-top: 3px
        - type: conditional
          conditions:
            - entity: input_boolean.heating_integration
              state: "on"
          card:
            type: custom:button-card
            entity: "switch.sw_thermostat"
            template: icon_state_header
            name: Riscaldamento
            tap_action:
              action: call-service
              service: automation.trigger
              service_data:
                entity_id: automation.manual_heating
            state:
              - value: "on"
                icon: mdi:radiator
                label: "Acceso"
                color: var(--command-state-active-color)
              - value: "off"
                icon: mdi:radiator-off
                label: "Spento"
                color: var(--command-state-color)
            styles:
              card:
                - padding-top: 3px
        - type: conditional
          conditions:
            - entity: input_boolean.heating_integration
              state: "on"
          card:
            type: "custom:button-card"
            template: header_icon_clima
            entity: binary_sensor.heater_auto
            state:
              - value: "on"
                color: var(--command-state-active-color)
                label: "acceso"
              - value: "off"
                color: var(--command-state-color)
            tap_action:
              action: navigate
              navigation_path: /lovelace-kairoshub/clima
            styles:
              card:
                - padding-top: 3px
